<!DOCTYPE html>

<html lang="en">
<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Redefining Convenience">
    <meta name="author" content="Maruf">

    <title>All Categories</title>

    <!-- Bootstrap core CSS -->
    <link href="./vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom fonts for this template -->
    <link href="./vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Merriweather:400,300,300italic,400italic,700,700italic,900,900italic' rel='stylesheet' type='text/css'>

    <!-- Plugin CSS -->
    <link href="./vendor/magnific-popup/magnific-popup.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="./stylesheets/creative.min.css" rel="stylesheet">

</head>

<body id="page-top">

    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav" style="position: relative; background-color: #f05f40;">
      <div class="container">
        <a class="navbar-brand js-scroll-trigger" href="./main">QatarHelp</a>        <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarResponsive">
          <ul class="navbar-nav ml-auto">
            <li class="nav-item">
              <a class="nav-link" href="./aboutUs">About</a>
            </li>
            <li class="nav-item ">
              <a class="nav-link" href="./faqPage">FAQ</a>
            </li>
            <li class="nav-item ">
              <a class="nav-link" href="/logout">Logout</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

 <section id="services" style="padding-top: 50px; padding-bottom: 50px;">
                    <div class="container">
                      <div class="col-lg-12 text-center">
                          <h2 class="section-heading">Delivery</h2>
                          <hr class="my-4">
                        </div>

                      <table id = "myTable">
                        <thead>
                          <tr>
                            <th> Request ID </th>
                            <th> Customer Name </th>
                            <th> Request Desc. </th>
                            <th> Address </th>
                            <th> Time </th>
                            <th> Price </th>
                            <th colspan="7"></th>
                          </tr>
                        </thead>

                      <!-- This is where the requests are rendered !-->
                        <tbody>
                          <% requests.forEach(function(request){ %>
                            <tr>
                              <td> <%= request.req_id %> </td>
                              <td> <%= request.first_name + " " + request.last_name %> </td>
                              <td> <%= request.service %> </td>
                              <td> <%= request.location %> </td>
                              <td> <%= request.time %> </td>
                              <td> <%= request.price %> </td>
                              <td> <a href = "#">Accept</a> </td>
                              <td> <a id = "my_id" href = "#" onclick="touch(this);">Make An Offer</a></td>
                            </tr>
                          <% }); %>
                        </tbody>
                      </table>
                      <script>
                        function touch(val){
                          console.log("afaefwef");

                          var row=$(val).closest("tr");
                          var id = $("td:eq(0)",row).text();
                          console.log(id);

                          var url = "./makeBid?id=" + (id - " ");
                          console.log(url);
                        //   setTimeout(function () { console.log("aaa") }, 5000);
                        // //  location.replace("./makeBid?id=");
                          $("#my_id").attr("href",url);
                        //   console.log(url);
                        // console.log(row);
                        // $(document).on('click',function(){
                        //         var row=$(this).closest("tr");
                        //         var id=$("td:eq(0)",row).text()
                        //         console.log(id); 
                        //      });

                        };
                        // (function (d) {
                        //   console.log("WTFFFF>>>?????")
                        //    // Get the table element
                        //    var table = function() {
                        //      var tables = d.getElementsByTagName('table');
                        //      return tables[tables.length - 1];
                        //    }();

                        //    table.onclick = function (e) {
                        //      var target = e.target;

                        //      // If an <a> was clicked
                        //      if( target.nodeName.toLowerCase() === 'a' ) {

                        //        // Find the tr containing that a
                        //        var node = target;
                        //        while (node.nodeName.toLowerCase() !== 'tr' )
                        //          node = node.parentNode;
                        //        var tr = node;

                        //        // Output the contents of the table cells in that row
                        //        var cells = tr.cells;
                        //        for (var i = 0; i < cells.length; i++ )
                        //            console.log(cells[i].innerHTML);

                        //        // Return false to prevent the link from loading
                        //        return false;
                        //      }
                        //    }
                        // })(document)
                      </script>
                      </div>
                  </section>

      
    <!-- Footer -->
    <footer class="text-center" >
      <div class="footer-above">
        <div class="container" >
          
      <div class="footer-below">
        <div class="container" style="position: absolute; bottom: 0;">
          <div class="row">
            <div class="col-lg-12">
              Copyright &copy; Senior Project 2017
            </div>
          </div>
        </div>
      </div>
      </div>
      </div>
    </footer>

    <!-- Bootstrap core JavaScript -->
    <script src="http://code.jquery.com/jquery.js"></script>
    <script src="./javascripts/bootstrap.min.js"></script>
      <script src = "./javascripts/fun.js"> </script>
    <script src="./javascripts/bootstrap.bundle.min.js"></script>
  </body>

</html>
